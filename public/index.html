<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YouTube Clone</title>
</head>
<body style="margin:0; display:grid; grid-template-rows: 60px 1fr; grid-template-columns: 100px 1fr;
             grid-template-areas: 'header header' 'sidebar main'; background-color:black; color:red; font-family:Arial, sans-serif; height:100vh;">

  <div style="grid-area: header; background-color: #202020; display: flex; align-items: center;
              justify-content: space-between; padding: 0 20px; border-bottom: 1px solid #333;">
    <h1 style="margin: 0; width: 220px; display: flex; justify-content: center; gap: 12px;">
      <img src="icon.png" alt="img" style="width: 55px;height: 50px;border-radius: 40px;"> YouTube
    </h1>
    <div style="display: flex; gap: 10px;">
      <input id="searchInput" type="text" placeholder="Search videos..." style="padding:5px 50px;border-radius: 20px; font-size: 16px; " />
      <button onclick={searchVideos(),clean()} style="padding: 5px 10px;">ğŸ”</button>
      <button onclick={Speak(),clean()} style="padding: 5px 10px;">ğŸ¤</button>
    </div>
  </div>

  <div style="grid-area: sidebar; background-color: #121212;width:200px; border-radius: 12px;">
    <ul style="list-style: none; padding: 0; margin: 0;">
      <li style="padding: 10px;margin-bottom: 10px; border-bottom: 1px solid gray;"><a href="#" style="color:white; text-decoration:none; font-weight: bolder; font-size: larger;">ğŸ  Home</a></li>
      <li style="padding: 10px;margin-bottom: 10px; border-bottom: 1px solid gray;"><a href="#" style="color:white; text-decoration:none; font-weight: bolder; font-size: larger;">ğŸ”¥ Trending</a></li>
      <li style="padding: 10px;margin-bottom: 10px; border-bottom: 1px solid gray;"><a href="#" style="color:white; text-decoration:none; font-weight: bolder; font-size: larger;">ğŸ“º Subscriptions</a></li>
      <li style="padding: 10px;margin-bottom: 10px; border-bottom: 1px solid gray;"><a href="#" style="color:white; text-decoration:none; font-weight: bolder; font-size: larger;">ğŸ“‚ Library</a></li>
    </ul>
  </div>

  <div style="grid-area: main; padding: 15px; margin-left: 100px;">
    <div data-video-container style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 30px;">
    </div>
    <div class="output">
        <p id="output" style="text-align: center; font-size: 24px;">Waiting for speech input...</p>
    </div>
  </div>

  <script>
    function clean(){
       Object.keys(localStorage).forEach(key=>{
           if(key.startsWith('video_')){
            localStorage.removeItem(key);
           }})
    }
    function renderstoredvideos(){
      const container = document.querySelector('[data-video-container]');
        container.innerHTML = '';
         
         for(let i=0;i<localStorage.length;i++){
          let key=localStorage.key(i);

          if(key.startsWith('video_')){
            const video=JSON.parse(localStorage.getItem(key))
          const videoCard = document.createElement('div');
          videoCard.style = "background-color:#2c2c2c;width: 320px; height:220px;border-radius: 5px; display:flex; align-items:center; justify-content:center;";

          videoCard.innerHTML = `
            <iframe src="https://www.youtube.com/embed/${video.videoId}" 
                    style="border-radius: 5px; width:360px ;height:240px" 
                    title="${video.title}" allowfullscreen loading="lazy"></iframe>
          `;

          container.appendChild(videoCard);
          }

      }
    }
    async function searchVideos(transcript) {
      console.log("transcript:",transcript);
      const query = document.getElementById('searchInput').value || transcript;
      // console.log(query );
      
      if (!query) return alert('Please enter a search term');

      try {
        const res = await fetch(`/video?q=${encodeURIComponent(query)}`);
        const data = await res.json();
        data.forEach(info=>{
          localStorage.setItem(`video_${info.videoId}`,JSON.stringify(info))
        })
        // alert('fine')
        renderstoredvideos();

     } catch (err) {
        console.error('Error fetching videos:', err);
        alert('Failed to load videos');
      }
    }

    async function Speak(){
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
             
               const scrib = {
                 show: (msg) => {
                   document.getElementById("output").textContent = msg;
                   console.log(msg);
                 }
               };
             
             
             if (!SpeechRecognition) {
               console.error("SpeechRecognition is not supported in this browser.");
             } else {
               const r = new SpeechRecognition();
               r.continuous = false;
               r.interimResults = false;
               r.maxAlternatives = 1;
             
               r.onstart = function () {
                 console.log("Speech recognition started");
                 scrib.show("R is started");
               };
             
               r.onresult = async function (event) {
                 const transcript = event.results[0][0].transcript;
                 console.log("Transcript:", transcript);
                 scrib.show(`You said: ${transcript}`);
                 searchVideos(transcript)
               };
               r.start()
               console.log("started")
             }
                 }
        window.addEventListener('DOMContentLoaded',renderstoredvideos)
  </script>
</body>
</html>


<!-- for making it fast -->

<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YouTube Clone</title>
  <link rel="preconnect" href="https://www.youtube.com">
  <link rel="preconnect" href="https://i.ytimg.com">
</head>
<body style="margin:0; display:grid; grid-template-rows: 60px 1fr; grid-template-columns: 100px 1fr;
             grid-template-areas: 'header header' 'sidebar main'; background-color:black; color:red; font-family:Arial, sans-serif; height:100vh;">

  <div style="grid-area: header; background-color: #202020; display: flex; align-items: center;
              justify-content: space-between; padding: 0 20px; border-bottom: 1px solid #333;">
    <h1 style="margin: 0; width: 220px; display: flex; justify-content: center; gap: 12px;">
      <img src="icon.png" alt="img" style="width: 55px;height: 50px;border-radius: 40px;"> YouTube
    </h1>
    <div style="display: flex; gap: 10px;">
      <input id="searchInput" type="text" placeholder="Search videos..." style="padding:5px 50px;border-radius: 20px; font-size: 16px;" />
      <button onclick="searchVideos(); clean();" style="padding: 5px 10px;">ğŸ”</button>
      <button onclick="Speak(); clean();" style="padding: 5px 10px;">ğŸ¤</button>
    </div>
  </div>

  <div style="grid-area: sidebar; background-color: #121212;width:200px; border-radius: 12px;">
    <ul style="list-style: none; padding: 0; margin: 0;">
      <li style="padding: 10px;margin-bottom: 10px; border-bottom: 1px solid gray;"><a href="#" style="color:white; text-decoration:none; font-weight: bolder; font-size: larger;">ğŸ  Home</a></li>
      <li style="padding: 10px;margin-bottom: 10px; border-bottom: 1px solid gray;"><a href="#" style="color:white; text-decoration:none; font-weight: bolder; font-size: larger;">ğŸ”¥ Trending</a></li>
      <li style="padding: 10px;margin-bottom: 10px; border-bottom: 1px solid gray;"><a href="#" style="color:white; text-decoration:none; font-weight: bolder; font-size: larger;">ğŸ“º Subscriptions</a></li>
      <li style="padding: 10px;margin-bottom: 10px; border-bottom: 1px solid gray;"><a href="#" style="color:white; text-decoration:none; font-weight: bolder; font-size: larger;">ğŸ“‚ Library</a></li>
    </ul>
  </div>

  <div style="grid-area: main; padding: 15px; margin-left: 100px;">
    <div data-video-container style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 30px;"></div>
    <div class="output">
      <p id="output" style="text-align: center; font-size: 24px;">Waiting for speech input...</p>
    </div>
  </div>

  <script>
    function clean() {
      Object.keys(localStorage).forEach(key => {
        if (key.startsWith('video_')) {
          localStorage.removeItem(key);
        }
      });
    }

    function loadIframe(container, videoId, title) {
      container.innerHTML = `
        <iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1"
                style="border-radius: 5px; width:100%; height:240px"
                title="${title}" allowfullscreen loading="lazy"></iframe>
      `;
    }

    function renderStoredVideos() {
      const container = document.querySelector('[data-video-container]');
      container.innerHTML = '';

      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('video_')) {
          const video = JSON.parse(localStorage.getItem(key));

          const videoCard = document.createElement('div');
          videoCard.style = "background-color:#2c2c2c;width: 320px; height:240px;border-radius: 5px; display:flex; align-items:center; justify-content:center; flex-direction:column; cursor:pointer;";
          videoCard.innerHTML = `
            <img src="${video.thumbnail}" alt="${video.title}" style="width:100%; border-radius:5px;" />
            <p style="color:white; text-align:center; font-size:14px;">${video.title}</p>
          `;
          videoCard.onclick = () => loadIframe(videoCard, video.videoId, video.title);
          container.appendChild(videoCard);
        }
      }
    }

    async function searchVideos(transcript) {
      const query = document.getElementById('searchInput').value || transcript;
      if (!query) return alert('Please enter a search term');

      try {
        const res = await fetch(`/video?q=${encodeURIComponent(query)}`);
        const data = await res.json();

        if (!Array.isArray(data)) {
          console.error("Unexpected response:", data);
          alert(data.error || "Something went wrong.");
          return;
        }

        data.forEach(info => {
          localStorage.setItem(`video_${info.videoId}`, JSON.stringify(info));
        });

        renderStoredVideos();
      } catch (err) {
        console.error('Error fetching videos:', err);
        alert('Failed to load videos');
      }
    }

    async function Speak() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      const scrib = {
        show: (msg) => {
          document.getElementById("output").textContent = msg;
          console.log(msg);
        }
      };

      if (!SpeechRecognition) {
        console.error("SpeechRecognition is not supported in this browser.");
      } else {
        const r = new SpeechRecognition();
        r.continuous = false;
        r.interimResults = false;
        r.maxAlternatives = 1;

        r.onstart = function () {
          console.log("Speech recognition started");
          scrib.show("Listening...");
        };

        r.onresult = async function (event) {
          const transcript = event.results[0][0].transcript;
          console.log("Transcript:", transcript);
          scrib.show(`You said: ${transcript}`);
          searchVideos(transcript);
        };

        r.start();
      }
    }

    window.addEventListener('DOMContentLoaded', renderStoredVideos);
  </script>
</body>
</html> -->